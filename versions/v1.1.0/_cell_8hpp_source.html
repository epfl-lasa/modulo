<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Modulo: /Users/enricoeberhard/Documents/EPFL/Dev/modulo/source/modulo_core/include/modulo_core/Cell.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Modulo
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_727f33ea6496bb66c2db4f7101f40bd7.html">modulo_core</a></li><li class="navelem"><a class="el" href="dir_30c9960b1e12cf048409514a1d0c5545.html">include</a></li><li class="navelem"><a class="el" href="dir_2397dea4246cf971150250488a69dca4.html">modulo_core</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Cell.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;chrono&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;lifecycle_msgs/msg/transition.hpp&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;rclcpp/function_traits.hpp&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;rclcpp/publisher.hpp&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;rclcpp/rclcpp.hpp&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;rclcpp_components/register_node_macro.hpp&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;rclcpp_lifecycle/lifecycle_node.hpp&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;rclcpp_lifecycle/lifecycle_publisher.hpp&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;rcutils/logging_macros.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;state_representation/parameters/Parameter.hpp&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;state_representation/parameters/ParameterInterface.hpp&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;modulo_core/communication/message_passing/PublisherHandler.hpp&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;modulo_core/communication/message_passing/SubscriptionHandler.hpp&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;modulo_core/communication/message_passing/TransformBroadcasterHandler.hpp&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;modulo_core/communication/message_passing/TransformListenerHandler.hpp&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;modulo_core/communication/service_client/ClientHandler.hpp&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd_1_1chrono__literals.html">std::chrono_literals</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemodulo_1_1core.html">modulo::core</a> {</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html">   39</a></span>&#160;<span class="keyword">class </span><a class="code" href="classmodulo_1_1core_1_1_cell.html">Cell</a> : <span class="keyword">public</span> rclcpp_lifecycle::LifecycleNode {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">bool</span> configured_;                                                                                      </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">bool</span> active_;                                                                                          </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">bool</span> shutdown_;                                                                                        </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  std::shared_ptr&lt;rclcpp::TimerBase&gt; update_parameters_timer_;                                           </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  std::chrono::nanoseconds period_;                                                                      </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  std::map&lt;std::string, std::shared_ptr&lt;state_representation::ParameterInterface&gt;&gt; parameters_;          </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  std::map&lt;std::string, std::pair&lt;std::shared_ptr&lt;communication::CommunicationHandler&gt;, <span class="keywordtype">bool</span>&gt;&gt; handlers_;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  std::list&lt;std::shared_ptr&lt;rclcpp::TimerBase&gt;&gt; timers_;                                                 </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  std::list&lt;std::shared_ptr&lt;rclcpp::TimerBase&gt;&gt; daemons_;                                                </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">void</span> reset();</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">void</span> add_transform_broadcaster(<span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                 <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                 <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">void</span> add_transform_listener(<span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; timeout);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">void</span> update_parameters();</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keyword">const</span> std::map&lt;std::string, std::pair&lt;std::shared_ptr&lt;communication::CommunicationHandler&gt;, <span class="keywordtype">bool</span>&gt;&gt;&amp; get_handlers() <span class="keyword">const</span>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;state_representation::ParameterInterface&gt; get_parameter_pointer(<span class="keyword">const</span> std::string&amp; parameter_name) <span class="keyword">const</span>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html">Cell</a>(<span class="keyword">const</span> std::string&amp; node_name, <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period, <span class="keywordtype">bool</span> intra_process_comms = <span class="keyword">false</span>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html">Cell</a>(<span class="keyword">const</span> rclcpp::NodeOptions&amp; options);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  ~<a class="code" href="classmodulo_1_1core_1_1_cell.html">Cell</a>();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">const</span> std::chrono::nanoseconds&amp; get_period() <span class="keyword">const</span>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">bool</span> is_configured() <span class="keyword">const</span>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">bool</span> is_active() <span class="keyword">const</span>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordtype">bool</span> is_shutdown() <span class="keyword">const</span>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MsgT, <span class="keyword">class</span> RecT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">void</span> add_publisher(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                     <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                     <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                     <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                     <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MsgT, <span class="keyword">class</span> RecT&gt;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">void</span> add_publisher(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                     <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                     <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                     <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> RecT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">void</span> add_state_publisher(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                           <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                           <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                           <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                           <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> RecT&gt;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">void</span> add_state_publisher(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                           <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                           <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                           <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MsgT, <span class="keyword">class</span> RecT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordtype">void</span> add_subscription(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                        <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                        <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; timeout,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                        <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MsgT, <span class="keyword">class</span> RecT&gt;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">void</span> add_subscription(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                        <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                        <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_period_to_timeout = 10,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> RecT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordtype">void</span> add_state_subscription(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                              <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                              <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; timeout,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                              <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                              <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> RecT&gt;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">void</span> add_state_subscription(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                              <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                              <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_period_to_timeout = 10,</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                              <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> srvT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">void</span> add_client(<span class="keyword">const</span> std::string&amp; channel, <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; timeout);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordtype">void</span> add_transform_broadcaster(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::CartesianState&gt;&amp; recipient,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                 <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                 <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                 <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordtype">void</span> add_transform_broadcaster(<span class="keyword">const</span> state_representation::CartesianPose&amp; recipient,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                 <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                 <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                 <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordtype">void</span> add_transform_broadcaster(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::ParameterInterface&gt;&amp; recipient,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                 <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                 <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                 <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordtype">void</span> add_transform_broadcaster(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::CartesianState&gt;&amp; recipient,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                 <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                 <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordtype">void</span> add_transform_broadcaster(<span class="keyword">const</span> state_representation::CartesianPose&amp; recipient,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                 <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                 <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordtype">void</span> add_transform_broadcaster(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::ParameterInterface&gt;&amp; recipient,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                 <span class="keywordtype">bool</span> always_active = <span class="keyword">false</span>,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                 <span class="keywordtype">int</span> queue_size = 10);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">void</span> add_parameter(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::Parameter&lt;T&gt;&gt;&amp; parameter, <span class="keyword">const</span> std::string&amp; prefix = <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">void</span> add_parameters(<span class="keyword">const</span> std::list&lt;std::shared_ptr&lt;state_representation::ParameterInterface&gt;&gt;&amp; parameters, <span class="keyword">const</span> std::string&amp; prefix = <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">void</span> set_parameter_value(<span class="keyword">const</span> std::string&amp; parameter_name, <span class="keyword">const</span> T&amp; value);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">void</span> set_parameter_value(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::Parameter&lt;T&gt;&gt;&amp; parameter);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">void</span> set_parameter_value(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::ParameterInterface&gt;&amp; parameter);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordtype">void</span> send_transform(<span class="keyword">const</span> state_representation::CartesianState&amp; transform, <span class="keyword">const</span> std::string&amp; name = <span class="stringliteral">&quot;&quot;</span>) <span class="keyword">const</span>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> srvT&gt;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  std::shared_ptr&lt;typename srvT::Response&gt; send_blocking_request(<span class="keyword">const</span> std::string&amp; channel, <span class="keyword">const</span> std::shared_ptr&lt;typename srvT::Request&gt;&amp; request);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> srvT&gt;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  std::shared_future&lt;std::shared_ptr&lt;typename srvT::Response&gt;&gt; send_request(<span class="keyword">const</span> std::string&amp; channel, <span class="keyword">const</span> std::shared_ptr&lt;typename srvT::Request&gt;&amp; request);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keyword">const</span> state_representation::CartesianPose lookup_transform(<span class="keyword">const</span> std::string&amp; frame_name, <span class="keyword">const</span> std::string&amp; reference_frame = <span class="stringliteral">&quot;world&quot;</span>) <span class="keyword">const</span>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn on_configure(<span class="keyword">const</span> rclcpp_lifecycle::State&amp;) <span class="keyword">override</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> on_configure();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn on_activate(<span class="keyword">const</span> rclcpp_lifecycle::State&amp;) <span class="keyword">override</span>;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> on_activate();</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn on_deactivate(<span class="keyword">const</span> rclcpp_lifecycle::State&amp;) <span class="keyword">override</span>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> on_deactivate();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn on_cleanup(<span class="keyword">const</span> rclcpp_lifecycle::State&amp;) <span class="keyword">override</span>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> on_cleanup();</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn on_shutdown(<span class="keyword">const</span> rclcpp_lifecycle::State&amp; state) <span class="keyword">override</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> on_shutdown();</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> step();</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordtype">void</span> run();</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordtype">void</span> run_periodic_call(<span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keywordtype">void</span>)&gt;&amp; callback_function);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordtype">void</span> add_periodic_call(<span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keywordtype">void</span>)&gt;&amp; callback_function, <span class="keyword">const</span> std::chrono::nanoseconds&amp; period);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordtype">void</span> add_daemon(<span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keywordtype">void</span>)&gt;&amp; callback_function, <span class="keyword">const</span> std::chrono::nanoseconds&amp; period);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;};</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a6f54f87fdeab9b58624f41a8c36c325c">  557</a></span>&#160;Cell::Cell(<span class="keyword">const</span> std::string&amp; node_name, <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period, <span class="keywordtype">bool</span> intra_process_comms) : rclcpp_lifecycle::LifecycleNode(node_name, rclcpp::NodeOptions().use_intra_process_comms(intra_process_comms)),</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                                                                                                              configured_(false),</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                                                                                                              active_(false),</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                                                                                                              shutdown_(false),</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                                                                                                              period_(period) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">// add the update parameters call</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  this-&gt;update_parameters_timer_ = this-&gt;create_wall_timer(this-&gt;period_, [<span class="keyword">this</span>] { this-&gt;update_parameters(); });</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a9c2dc9803620fff2ed5995bbabd5fb32">  566</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> std::map&lt;std::string, std::pair&lt;std::shared_ptr&lt;communication::CommunicationHandler&gt;, <span class="keywordtype">bool</span>&gt;&gt;&amp; <a class="code" href="classmodulo_1_1core_1_1_cell.html#a9c2dc9803620fff2ed5995bbabd5fb32">Cell::get_handlers</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">return</span> this-&gt;handlers_;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;}</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a3474ece0416029d4f404af1b2910c1d6">  570</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#a3474ece0416029d4f404af1b2910c1d6">Cell::is_configured</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">return</span> this-&gt;configured_;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;}</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#ace47d79114cbba0fd4d84088df49a1ea">  574</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#ace47d79114cbba0fd4d84088df49a1ea">Cell::is_active</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">return</span> this-&gt;active_;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#aca6cd4b8d5d95ee9df36963902f1dbc1">  578</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#aca6cd4b8d5d95ee9df36963902f1dbc1">Cell::is_shutdown</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordflow">return</span> this-&gt;shutdown_;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#af13211781282916bdcd836289088f729">  582</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> std::chrono::nanoseconds&amp; <a class="code" href="classmodulo_1_1core_1_1_cell.html#af13211781282916bdcd836289088f729">Cell::get_period</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">return</span> this-&gt;period_;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a9605a6d6f3cd7e25a2cd7c1fc055f598">  586</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> std::shared_ptr&lt;state_representation::ParameterInterface&gt; <a class="code" href="classmodulo_1_1core_1_1_cell.html#a9605a6d6f3cd7e25a2cd7c1fc055f598">Cell::get_parameter_pointer</a>(<span class="keyword">const</span> std::string&amp; parameter_name)<span class="keyword"> const </span>{</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">return</span> this-&gt;parameters_.at(parameter_name);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a56c491b299de1d33d8f32389cdfd5c9b">  591</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#aee6e888001df99c8201dc728709d05ae">Cell::set_parameter_value</a>(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::Parameter&lt;T&gt;&gt;&amp; parameter) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  this-&gt;set_parameter_value&lt;T&gt;(parameter-&gt;get_name(), parameter-&gt;get_value());</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MsgT, <span class="keyword">class</span> RecT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a9db583f79249081e49dcd5867801a1da">  596</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#a9db583f79249081e49dcd5867801a1da">Cell::add_publisher</a>(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                         <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                         <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                         <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                         <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keyword">auto</span> handler = std::make_shared&lt;communication::PublisherHandler&lt;RecT, MsgT&gt;&gt;(recipient, this-&gt;get_clock());</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  handler-&gt;set_publisher(this-&gt;create_publisher&lt;MsgT&gt;(channel, queue_size));</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  handler-&gt;set_timer(this-&gt;create_wall_timer(period, [handler] { handler-&gt;publish_callback(); }));</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  this-&gt;handlers_.insert(std::make_pair(channel, std::make_pair(handler, always_active)));</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment">// if the handler is always active, activate it directly</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">if</span> (always_active) {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    handler-&gt;activate();</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MsgT, <span class="keyword">class</span> RecT&gt;</div><div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#ad29cfa3a50c8e5dff204d8d3a77bbfdd">  612</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#a9db583f79249081e49dcd5867801a1da">Cell::add_publisher</a>(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                         <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                         <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                         <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  this-&gt;add_publisher&lt;MsgT, RecT&gt;(channel, recipient, this-&gt;period_, always_active, queue_size);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;}</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> RecT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a5e7606dc7a4d36f1f8bb8e4011087a7d">  620</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#a5e7606dc7a4d36f1f8bb8e4011087a7d">Cell::add_state_publisher</a>(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                               <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                               <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                               <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                               <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  this-&gt;add_publisher&lt;EncodedState, RecT&gt;(channel, recipient, period, always_active, queue_size);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;}</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> RecT&gt;</div><div class="line"><a name="l00629"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#adbb76634b4d55866ee751127082906c9">  629</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#a5e7606dc7a4d36f1f8bb8e4011087a7d">Cell::add_state_publisher</a>(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                               <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                               <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                               <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  this-&gt;add_publisher&lt;EncodedState, RecT&gt;(channel, recipient, always_active, queue_size);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MsgT, <span class="keyword">class</span> RecT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a7389de153da8a35b50ee7c089a806b4a">  637</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#a7389de153da8a35b50ee7c089a806b4a">Cell::add_subscription</a>(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                            <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                            <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; timeout,</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                            <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                            <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keyword">auto</span> handler = std::make_shared&lt;communication::SubscriptionHandler&lt;RecT, MsgT&gt;&gt;(recipient, timeout);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  handler-&gt;set_subscription(this-&gt;create_subscription&lt;MsgT&gt;(channel, queue_size, [handler](<span class="keyword">const</span> std::shared_ptr&lt;MsgT&gt; msg) { handler-&gt;subscription_callback(msg); }));</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  this-&gt;handlers_.insert(std::make_pair(channel, std::make_pair(handler, always_active)));</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">if</span> (always_active) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    handler-&gt;activate();</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;}</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MsgT, <span class="keyword">class</span> RecT&gt;</div><div class="line"><a name="l00651"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#ab3f36681d56926a2e6d091953f337eb7">  651</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#a7389de153da8a35b50ee7c089a806b4a">Cell::add_subscription</a>(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                            <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                            <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_period_to_timeout,</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                            <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  this-&gt;add_subscription&lt;MsgT, RecT&gt;(channel, recipient, nb_period_to_timeout * this-&gt;period_, always_active, queue_size);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> RecT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#ad95ae271520a43ff6cebfee4dcc3ca8c">  660</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#ad95ae271520a43ff6cebfee4dcc3ca8c">Cell::add_state_subscription</a>(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                  <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                  <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; timeout,</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                  <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                  <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  this-&gt;add_subscription&lt;EncodedState, RecT&gt;(channel, recipient, timeout, always_active, queue_size);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> RecT&gt;</div><div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a20fee86d69a6a08d16f3e3e81b526522">  669</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#ad95ae271520a43ff6cebfee4dcc3ca8c">Cell::add_state_subscription</a>(<span class="keyword">const</span> std::string&amp; channel,</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                  <span class="keyword">const</span> std::shared_ptr&lt;RecT&gt;&amp; recipient,</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                  <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_period_to_timeout,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                  <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  this-&gt;add_subscription&lt;EncodedState, RecT&gt;(channel, recipient, nb_period_to_timeout, always_active, queue_size);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="keywordtype">void</span> Cell::add_transform_broadcaster(<span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                     <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                     <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keyword">auto</span> handler = std::make_shared&lt;communication::TransformBroadcasterHandler&gt;(this-&gt;get_clock());</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  handler-&gt;set_publisher(this-&gt;create_publisher&lt;tf2_msgs::msg::TFMessage&gt;(<span class="stringliteral">&quot;tf&quot;</span>, queue_size));</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  handler-&gt;set_timer(this-&gt;create_wall_timer(period, [handler] { handler-&gt;publish_callback(); }));</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  this-&gt;handlers_.insert(std::make_pair(<span class="stringliteral">&quot;tf_broadcaster&quot;</span>, std::make_pair(handler, always_active)));</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">if</span> (always_active) {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    handler-&gt;activate();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00691"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#ae4927517bf0bc8b94d6cb5decefb823b">  691</a></span>&#160;<span class="keywordtype">void</span> Cell::add_transform_broadcaster(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::CartesianState&gt;&amp; recipient,</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                     <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                     <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                     <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keyword">auto</span> handler = std::make_shared&lt;communication::TransformBroadcasterHandler&gt;(recipient, this-&gt;get_clock());</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  handler-&gt;set_publisher(this-&gt;create_publisher&lt;tf2_msgs::msg::TFMessage&gt;(<span class="stringliteral">&quot;tf&quot;</span>, queue_size));</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  handler-&gt;set_timer(this-&gt;create_wall_timer(period, [handler] { handler-&gt;publish_callback(); }));</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  this-&gt;handlers_.insert(std::make_pair(recipient-&gt;get_name() + <span class="stringliteral">&quot;_in_&quot;</span> + recipient-&gt;get_reference_frame() + <span class="stringliteral">&quot;_broadcaster&quot;</span>, std::make_pair(handler, always_active)));</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">if</span> (always_active) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    handler-&gt;activate();</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a93af246ceb62834fba40ae7e196a4f6f">  705</a></span>&#160;<span class="keywordtype">void</span> Cell::add_transform_broadcaster(<span class="keyword">const</span> state_representation::CartesianPose&amp; recipient,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                     <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                     <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                     <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  this-&gt;add_transform_broadcaster(std::make_shared&lt;state_representation::CartesianPose&gt;(recipient), period, always_active, queue_size);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;}</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a33d6de7a100ec206d253fb5c464568bb">  713</a></span>&#160;<span class="keywordtype">void</span> Cell::add_transform_broadcaster(<span class="keyword">const</span> std::shared_ptr&lt;state_representation::ParameterInterface&gt;&amp; recipient,</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                     <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; period,</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                     <span class="keywordtype">bool</span> always_active,</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                     <span class="keywordtype">int</span> queue_size) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keyword">using namespace </span>communication;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespacestate__representation.html">state_representation</a>;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keyword">auto</span> parameter = std::static_pointer_cast&lt;Parameter&lt;CartesianPose&gt;&gt;(recipient);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keyword">auto</span> handler = std::make_shared&lt;PublisherHandler&lt;Parameter&lt;CartesianPose&gt;, tf2_msgs::msg::TFMessage&gt;&gt;(parameter, this-&gt;get_clock());</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  handler-&gt;set_publisher(this-&gt;create_publisher&lt;tf2_msgs::msg::TFMessage&gt;(<span class="stringliteral">&quot;tf&quot;</span>, queue_size));</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  handler-&gt;set_timer(this-&gt;create_wall_timer(period, [handler] { handler-&gt;publish_callback(); }));</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  this-&gt;handlers_.insert(std::make_pair(parameter-&gt;get_value().get_name() + <span class="stringliteral">&quot;_in_&quot;</span> + parameter-&gt;get_value().get_reference_frame() + <span class="stringliteral">&quot;_broadcaster&quot;</span>, std::make_pair(handler, always_active)));</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">if</span> (always_active) {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    handler-&gt;activate();</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;}</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keywordtype">void</span> Cell::add_transform_listener(<span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; timeout) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keyword">auto</span> handler = std::make_shared&lt;communication::TransformListenerHandler&gt;(timeout, this-&gt;get_clock());</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  this-&gt;handlers_.insert(std::make_pair(<span class="stringliteral">&quot;tf_listener&quot;</span>, std::make_pair(handler, <span class="keyword">false</span>)));</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> srvT, <span class="keyword">typename</span> DurationT&gt;</div><div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a38f0168a5774facb8660e8527d4827a9">  736</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmodulo_1_1core_1_1_cell.html#a38f0168a5774facb8660e8527d4827a9">Cell::add_client</a>(<span class="keyword">const</span> std::string&amp; channel, <span class="keyword">const</span> std::chrono::duration&lt;int64_t, DurationT&gt;&amp; timeout) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keyword">auto</span> handler = std::make_shared&lt;communication::ClientHandler&lt;srvT&gt;&gt;(timeout);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  handler-&gt;set_client(this-&gt;create_client&lt;srvT&gt;(channel));</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  this-&gt;handlers_.insert(std::make_pair(channel, std::make_pair(handler, <span class="keyword">false</span>)));</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> srvT&gt;</div><div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a2b911abe115972016e13913d6349d84e">  743</a></span>&#160;std::shared_ptr&lt;typename srvT::Response&gt; <a class="code" href="classmodulo_1_1core_1_1_cell.html#a2b911abe115972016e13913d6349d84e">Cell::send_blocking_request</a>(<span class="keyword">const</span> std::string&amp; channel, <span class="keyword">const</span> std::shared_ptr&lt;typename srvT::Request&gt;&amp; request) {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="classmodulo_1_1core_1_1communication_1_1_client_handler.html">communication::ClientHandler&lt;srvT&gt;</a>&amp;<span class="keyword">&gt;</span>(*this-&gt;handlers_.at(channel).first).<a class="code" href="classmodulo_1_1core_1_1_cell.html#a2b911abe115972016e13913d6349d84e">send_blocking_request</a>(request);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> srvT&gt;</div><div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="classmodulo_1_1core_1_1_cell.html#a8be9304077256da63314cb715cf66a1e">  748</a></span>&#160;std::shared_future&lt;std::shared_ptr&lt;typename srvT::Response&gt;&gt; <a class="code" href="classmodulo_1_1core_1_1_cell.html#a8be9304077256da63314cb715cf66a1e">Cell::send_request</a>(<span class="keyword">const</span> std::string&amp; channel, <span class="keyword">const</span> std::shared_ptr&lt;typename srvT::Request&gt;&amp; request) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="classmodulo_1_1core_1_1communication_1_1_client_handler.html">communication::ClientHandler&lt;srvT&gt;</a>&amp;<span class="keyword">&gt;</span>(*this-&gt;handlers_.at(channel).first).<a class="code" href="classmodulo_1_1core_1_1_cell.html#a8be9304077256da63314cb715cf66a1e">send_request</a>(request);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;}<span class="comment">// namespace modulo::core</span></div><div class="ttc" id="namespacestate__representation_html"><div class="ttname"><a href="namespacestate__representation.html">state_representation</a></div></div>
<div class="ttc" id="namespacestd_1_1chrono__literals_html"><div class="ttname"><a href="namespacestd_1_1chrono__literals.html">chrono_literals</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a7389de153da8a35b50ee7c089a806b4a"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a7389de153da8a35b50ee7c089a806b4a">modulo::core::Cell::add_subscription</a></div><div class="ttdeci">void add_subscription(const std::string &amp;channel, const std::shared_ptr&lt; RecT &gt; &amp;recipient, const std::chrono::duration&lt; int64_t, DurationT &gt; &amp;timeout, bool always_active=false, int queue_size=10)</div><div class="ttdoc">Template function to add a generic subscription to the map of handlers. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00637">Cell.hpp:637</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_ace47d79114cbba0fd4d84088df49a1ea"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#ace47d79114cbba0fd4d84088df49a1ea">modulo::core::Cell::is_active</a></div><div class="ttdeci">bool is_active() const</div><div class="ttdoc">Getter of the active boolean attribute. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00574">Cell.hpp:574</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a9db583f79249081e49dcd5867801a1da"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a9db583f79249081e49dcd5867801a1da">modulo::core::Cell::add_publisher</a></div><div class="ttdeci">void add_publisher(const std::string &amp;channel, const std::shared_ptr&lt; RecT &gt; &amp;recipient, const std::chrono::duration&lt; int64_t, DurationT &gt; &amp;period, bool always_active=false, int queue_size=10)</div><div class="ttdoc">Template function to add a generic publisher to the map of handlers. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00596">Cell.hpp:596</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a2b911abe115972016e13913d6349d84e"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a2b911abe115972016e13913d6349d84e">modulo::core::Cell::send_blocking_request</a></div><div class="ttdeci">std::shared_ptr&lt; typename srvT::Response &gt; send_blocking_request(const std::string &amp;channel, const std::shared_ptr&lt; typename srvT::Request &gt; &amp;request)</div><div class="ttdoc">Send a request to the server and wait for its response. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00743">Cell.hpp:743</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_af13211781282916bdcd836289088f729"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#af13211781282916bdcd836289088f729">modulo::core::Cell::get_period</a></div><div class="ttdeci">const std::chrono::nanoseconds &amp; get_period() const</div><div class="ttdoc">Getter of the period attribute. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00582">Cell.hpp:582</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a38f0168a5774facb8660e8527d4827a9"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a38f0168a5774facb8660e8527d4827a9">modulo::core::Cell::add_client</a></div><div class="ttdeci">void add_client(const std::string &amp;channel, const std::chrono::duration&lt; int64_t, DurationT &gt; &amp;timeout)</div><div class="ttdoc">Template function to add a generic client to the map of handlers. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00736">Cell.hpp:736</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a9605a6d6f3cd7e25a2cd7c1fc055f598"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a9605a6d6f3cd7e25a2cd7c1fc055f598">modulo::core::Cell::get_parameter_pointer</a></div><div class="ttdeci">const std::shared_ptr&lt; state_representation::ParameterInterface &gt; get_parameter_pointer(const std::string &amp;parameter_name) const</div><div class="ttdoc">Get the pointer to the desired parameter. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00586">Cell.hpp:586</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_ad95ae271520a43ff6cebfee4dcc3ca8c"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#ad95ae271520a43ff6cebfee4dcc3ca8c">modulo::core::Cell::add_state_subscription</a></div><div class="ttdeci">void add_state_subscription(const std::string &amp;channel, const std::shared_ptr&lt; RecT &gt; &amp;recipient, const std::chrono::duration&lt; int64_t, DurationT &gt; &amp;timeout, bool always_active=false, int queue_size=10)</div><div class="ttdoc">Template function to add a specific state subscription that makes use of protobuf decoding to the map...</div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00660">Cell.hpp:660</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_aee6e888001df99c8201dc728709d05ae"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#aee6e888001df99c8201dc728709d05ae">modulo::core::Cell::set_parameter_value</a></div><div class="ttdeci">void set_parameter_value(const std::string &amp;parameter_name, const T &amp;value)</div><div class="ttdoc">Set the value of a declared parameter. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8cpp_source.html#l00242">Cell.cpp:242</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a8be9304077256da63314cb715cf66a1e"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a8be9304077256da63314cb715cf66a1e">modulo::core::Cell::send_request</a></div><div class="ttdeci">std::shared_future&lt; std::shared_ptr&lt; typename srvT::Response &gt; &gt; send_request(const std::string &amp;channel, const std::shared_ptr&lt; typename srvT::Request &gt; &amp;request)</div><div class="ttdoc">Send a request to the server without waiting for its response. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00748">Cell.hpp:748</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1communication_1_1_client_handler_html"><div class="ttname"><a href="classmodulo_1_1core_1_1communication_1_1_client_handler.html">modulo::core::communication::ClientHandler</a></div><div class="ttdoc">Class to define a client. </div><div class="ttdef"><b>Definition:</b> <a href="_client_handler_8hpp_source.html#l00014">ClientHandler.hpp:14</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a3474ece0416029d4f404af1b2910c1d6"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a3474ece0416029d4f404af1b2910c1d6">modulo::core::Cell::is_configured</a></div><div class="ttdeci">bool is_configured() const</div><div class="ttdoc">Getter of the configured boolean attribute. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00570">Cell.hpp:570</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_aca6cd4b8d5d95ee9df36963902f1dbc1"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#aca6cd4b8d5d95ee9df36963902f1dbc1">modulo::core::Cell::is_shutdown</a></div><div class="ttdeci">bool is_shutdown() const</div><div class="ttdoc">Getter of the shutdown boolean attribute. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00578">Cell.hpp:578</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html">modulo::core::Cell</a></div><div class="ttdoc">Abstract class to define a Cell A Cell is the base class of the whole architecture. It handles all the basic ROS communications such as definitions of subscriptions, publishers and service calls. It can then be derived into a MotionGenerator, a Controller, a Sensor, or a RobotInterface. It is derived from a lifecycle node which allows to use ROS2 state machine functionalities for nodes. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00039">Cell.hpp:39</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a9c2dc9803620fff2ed5995bbabd5fb32"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a9c2dc9803620fff2ed5995bbabd5fb32">modulo::core::Cell::get_handlers</a></div><div class="ttdeci">const std::map&lt; std::string, std::pair&lt; std::shared_ptr&lt; communication::CommunicationHandler &gt;, bool &gt; &gt; &amp; get_handlers() const</div><div class="ttdoc">Getter of the handlers attribute. </div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00566">Cell.hpp:566</a></div></div>
<div class="ttc" id="classmodulo_1_1core_1_1_cell_html_a5e7606dc7a4d36f1f8bb8e4011087a7d"><div class="ttname"><a href="classmodulo_1_1core_1_1_cell.html#a5e7606dc7a4d36f1f8bb8e4011087a7d">modulo::core::Cell::add_state_publisher</a></div><div class="ttdeci">void add_state_publisher(const std::string &amp;channel, const std::shared_ptr&lt; RecT &gt; &amp;recipient, const std::chrono::duration&lt; int64_t, DurationT &gt; &amp;period, bool always_active=false, int queue_size=10)</div><div class="ttdoc">Template function to add a specific state publisher that makes use of protobuf encodings to the map o...</div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00620">Cell.hpp:620</a></div></div>
<div class="ttc" id="namespacemodulo_1_1core_html"><div class="ttname"><a href="namespacemodulo_1_1core.html">modulo::core</a></div><div class="ttdef"><b>Definition:</b> <a href="_cell_8hpp_source.html#l00027">Cell.hpp:27</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
